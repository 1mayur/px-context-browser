/*
 * Copyright (c) 2014 GE Global Research. All rights reserved.
 *
 * The copyright to the computer software herein is the property of
 * GE Global Research. The software may be used and/or copied only
 * with the written permission of GE Global Research or in accordance
 * with the terms and conditions stipulated in the agreement/contract
 * under which the software has been supplied.
 */

//
// Sass for the Predix notion of the px-context-browser component
//
// @author: Oren J. Ferrari
//

@import "px-context-browser-sketch";


$side-nav-em-pixel-ratio: 1.0em / 15;
// 1.6em = 24px;

// Default Transition Length
$default-transition-length: 0.35s;
$default-transition-params: $default-transition-length ease 0s;

$min-width: 240;
$ruler-width: $side-nav-em-pixel-ratio * $min-width;

.relative {
  position: relative;
}
.absolute {
  position: absolute;
}

.spacer {

  &, &-x {
    width: 1ex;
  }

  &, &-2-x {
    width: 2ex;
  }

}

span.spacer {
  &, &-2 {
    &, &-x {
      display: inline-block;
    }
  }
}

.scroll-y {
  overflow-y: scroll;
}

.flex {
  &, &-x, &-y, &ible-body, &-middle {
    display: -webkit-box; // OLD - iOS 6-, Safari 3.1-6
    display: -moz-box; // OLD - Firefox 19- (buggy but mostly works)
    display: -ms-flexbox; // TWEENER - IE 10
    display: -webkit-flex; // NEW - Chrome
    display: flex;
  }

  &-x {
    -webkit-box-orient: horizontal;
    -webkit-flex-direction: row;
    -ms-flex-direction: row;
    flex-direction: row;
  }
  &-y, &ible-body {
    -webkit-box-orient: vertical;
    -webkit-flex-direction: column;
    -ms-flex-direction: column;
    flex-direction: column;
  }
  &-1, &ible-body > .body {
    -webkit-box-flex: 1;
    -moz-box-flex: 1;
    -webkit-flex: 1;
    -ms-flex: 1;
    flex: 1;
  }

  &-middle {
    -webkit-align-items: center;
    -ms-flex-align: center;
    align-items: center;
  }

}

.full {
  &-xy, &-x {
    width: 100%;
  }
  &-xy, &-y {
    height: 100%;
  }
}

@mixin columnConfig($columns) {
  &.columns-#{$columns} {
    > div {
      width: 100%/$columns;
    }
  }
  &.column-index-#{$columns} {
    > div {
      &:nth-child(-n + #{$columns}) {
        margin-left: -$ruler-width;
        width: $ruler-width;
        overflow: hidden;

        html[dir=rtl] & {
          margin-right: -$ruler-width;
          margin-left: 0;
        }
      }
    }
  }
}

// The actual column browser resides within...
.column-browser {

  // column-browser-container is on the outside of .column-browser
  &-container {
    * {
      overflow: hidden;
    }
    .scroll-y {
      overflow-y: scroll;
    }

    .breadcrumb,
    .selectable-item {
      cursor: pointer;
    }

    // Height enforcement.
    .breadcrumbConnector:first-of-type {
      width:0;
      visibility: hidden;
    }

    .breadcrumbConnector:last-of-type {
      display: none;
    }

    > div > .head {
      line-height: 2;
    }
  }


  > div {
    @include columnConfig(1);
    @include columnConfig(2);
    @include columnConfig(3);
    @include columnConfig(4);
    @include columnConfig(5);
    @include columnConfig(6);
    @include columnConfig(7);
    @include columnConfig(8);
    @include columnConfig(9);
    @include columnConfig(10);
    @include columnConfig(11);
    @include columnConfig(12);
  }

  .column {

    transform: translateZ(0); // This is a special hack to prevent font-awesome (or any other transformed element) from rendering on top of this unexpectedly.
    transition:
      width $default-transition-params,
      min-width $default-transition-params,
      margin-left $default-transition-params,
      margin-right $default-transition-params,
      opacity $default-transition-params;

    box-sizing: border-box;
    border-width: 1px;
    border-style: solid;
    border-top: 0;
    border-bottom: 0;
    html:not([dir=rtl]) & {
      border-left-width: 0;
    }

    html[dir=rtl] & {
      border-right-width: 0;
    }

    &.new, &.removed {
      width: 0;
      min-width: 0;
      opacity: 0;
    }

    &.new {
      visibility: hidden;
    }
  }

  .ruler {
    position: absolute;
    visibility: hidden;
    height: 0;
    top: 0;
    left: 0;
  }


  .column,
  .ruler {
    width: $ruler-width;
  }

  // An extra div is required to enforce the inner boundary even when the outer is animating.
  .column > div
  {
    min-width: $ruler-width;
    width:100.5%; // Ensures pixels fill out at the edge of a % defined container width.
  }

  ul {
    margin: 0;
    padding: 0;
  }

  .level {
    li {
      transition: color 0.2s ease 0s, background-color 0.2s ease 0s; // TODO: establish default transition length;

      line-height: 2;
      .opener {
        cursor: pointer;
        &.unopenable {
          display: none; //opener on unopenable items is never displayed and not seen by screen readers
        }
      }
    }

    li:not(.selected) .opener.openable {
      // Do not use display:none to avoid altering visual tree structure live or conflicting with flex layout.
      visibility: hidden; //opener on openable items not in a selected row is not displayed and not seen by screen readers
    }
    &:not(.selected) {
      li:not(.selected) .opener.openable {
        visibility: hidden; //opener on openable items not in a selected row is not displayed and not seen by screen readers
      }
    }
    li:not(.selected):hover .opener.openable {
      visibility: visible; //opener on openable items not in a selected row is not displayed and not seen by screen readers
    }
  }
}

@import "px-context-browser-predix";

