<!doctype html>

<html>
    <head>
        <title>px-3-column-browser Demo</title>

        <!-- Requires Webcomponents.js polyfill is provided by the page for browsers that don't support html imports -->
        <script src="../webcomponentsjs/webcomponents.js"></script>

        <!-- Import custom element. Note: see comment about relative paths to dependencies in the *.html file referenced below -->
        <link rel="import" href="px-3-column-browser.html"/>
    </head>

    <body>

        <h3>Demo</h3>

        <p>
            Although related, examples are /not/ the same as the test fixtures.
            Tests are tests, examples are examples.
        </p>

        <p>
            Also see the <a href="index.html">documentation</a> and the <a href="test/spec.html">UI test fixture</a>.
        </p>


        <px-3-column-browser
                label-field="name"
                parent-id-field="category"
                id-field="identifier"
                tree-display-levels="3"
                child-key="children">
        </px-3-column-browser>

        <!-- for demo only...never do this. Rely on Angular $q if using angular or load this via amd or other loader -->
        <script src="http://cdnjs.cloudflare.com/ajax/libs/q.js/0.9.6/q.js"></script>

        <script>
            var initialContexts = {
                data: [{
                    "name": "Mustang",
                    "identifier": "001-1",
                    "parent": "top",
                    "classification": "truck"
                }, {
                    "name": "Sandy Bridges",
                    "identifier": "001-2",
                    "parent": "top",
                    "classification": "car"
                }, {
                    "name": "Nothing Below Me",
                    "identifier": "001-3",
                    "parent": "top",
                    "classification": "car"
                }],
                meta: {
                    total: 3 // total number of entities on all pages (to support pagination)
                }
            };

            window.setTimeout(function() {

                var colBrowser = document.querySelector('px-3-column-browser');
                colBrowser.handlers = {getChildren: function(parentId, newIndex) {return demoGetChildren(parentId, newIndex )}, isOpenable: function(node) {return node && node.isOpenable}};
                colBrowser.initialContexts = initialContexts;
            }, 2000);

            function demoGetChildren(nodeId, newIndex) {
                var deferred = Q.defer();
                var mustangChildren = {
                    data: [{
                        "name": "A",
                        "identifier": "001-1a",
                        "parent": "001-1",
                        "classification": "truck"
                    }, {
                        "name": "B",
                        "identifier": "001-1b",
                        "parent": "001-1",
                        "classification": "car"
                    }, {
                        "name": "C",
                        "identifier": "001-1c",
                        "parent": "001-1",
                        "classification": "car"
                    },{
                        "name": "D",
                        "identifier": "001-1d",
                        "parent": "001-1",
                        "classification": "truck"
                    }, {
                        "name": "E",
                        "identifier": "001-1e",
                        "parent": "001-1",
                        "classification": "car"
                    }, {
                        "name": "F",
                        "identifier": "001-1f",
                        "parent": "001-1",
                        "classification": "car"
                    },{
                        "name": "G",
                        "identifier": "001-1g",
                        "parent": "001-1",
                        "classification": "truck"
                    }, {
                        "name": "H",
                        "identifier": "001-1h",
                        "parent": "001-1",
                        "classification": "car"
                    }, {
                        "name": "I",
                        "identifier": "001-1i",
                        "parent": "001-1",
                        "classification": "car"
                    }],
                    meta: {
                        total: 9 // total number of entities on all pages (to support pagination)
                    }
                };
                var bridgesChildren = {
                    data: [{
                        "name": "BridgeChild",
                        "identifier": "001-2a",
                        "parent": "001-2",
                        "classification": "truck",
                        "isOpenable": true
                    }],
                    meta: {
                        total: 1 // total number of entities on all pages (to support pagination)
                    }
                };

                var bridgesGrandchildren = {
                    data: [{
                        "name": "BridgeGrandchild",
                        "identifier": "001-2aa",
                        "parent": "001-2a",
                        "classification": "truck"
                    }],
                    meta: {
                        total: 1 // total number of entities on all pages (to support pagination)
                    }
                };

                var bridgesGreatGrandchild = {
                    data: [{
                        "name": "BridgeGreatGrandchild",
                        "identifier": "001-2aaa",
                        "parent": "001-2aa",
                        "classification": "truck",
                        "isOpenable": true
                    }],
                    meta: {
                        total: 1 // total number of entities on all pages (to support pagination)
                    }
                };

                var children = {
                    data: [],
                    meta: {
                        total: 0
                    }
                };

                if (nodeId === "001-1") {
                    children = mustangChildren;
                }
                if (nodeId === "001-2") {
                    children = bridgesChildren;
                }
                if (nodeId === "001-2a") {
                    children = bridgesGrandchildren;
                }
                if (nodeId === "001-2aa") {
                    children = bridgesGreatGrandchild;
                }

                deferred.resolve(children);

                return deferred.promise;
            }


        </script>

    </body>
</html>